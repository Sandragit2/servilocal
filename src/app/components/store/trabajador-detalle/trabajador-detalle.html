<div class="detalle-wrapper" *ngIf="trabajador">

  <!-- üîô Bot√≥n volver -->
  <button class="btn-regresar" routerLink="/store/services/{{ trabajador.categoria }}">
    ‚¨Ö Volver
  </button>

  <!-- ‚≠ê Tarjeta principal -->
  <div class="card-detalle">

    <!-- üìå FOTO + NOMBRE -->
    <div class="perfil-header">
      <img
        [src]="urlBackend + trabajador.foto_trabajador"
        onerror="this.src='assets/img/default-user.png'"
        class="foto"
        alt="Foto del trabajador"
      />

      <div class="info-basica">
        <h2>{{ trabajador.nombre }} {{ trabajador.apellidos }}</h2>
        <p class="categoria">{{ trabajador.categoria | titlecase }}</p>

        <!-- Estrellas -->
        <div class="estrellas">
          <ng-container *ngIf="trabajador.calificacion_promedio; else noCalif">
            <span
              *ngFor="let s of [1, 2, 3, 4, 5]"
              class="star"
              [class.filled]="s <= trabajador.calificacion_promedio"
            >‚òÖ</span>
            <span class="promedio">{{ trabajador.calificacion_promedio }}/5</span>
          </ng-container>

          <ng-template #noCalif>
            <span class="no-calif">Sin calificaciones</span>
          </ng-template>
        </div>
      </div>
    </div>

    <!-- DESCRIPCI√ìN -->
    <section class="section">
      <h3>Descripci√≥n</h3>
      <p>{{ trabajador.descripcion_trabajo || 'Sin descripci√≥n.' }}</p>
    </section>

    <!-- CONTACTO -->
    <section class="section">
      <h3>Contacto</h3>
      <p><strong>Tel√©fono:</strong> {{ trabajador.telefono || 'No disponible' }}</p>
      <p><strong>Correo:</strong> {{ trabajador.correo || 'No disponible' }}</p>
      <p><strong>Ubicaci√≥n:</strong> {{ trabajador.ubicacion || 'No especificada' }}</p>
    </section>

    <!-- EXPERIENCIA -->
    <section class="section">
      <h3>Experiencia</h3>
      <p>{{ trabajador.experiencia || 'Este trabajador no ha registrado experiencia.' }}</p>
    </section>

    <!-- HABILIDADES -->
    <section class="section">
      <h3>Habilidades</h3>
      <p>{{ trabajador.habilidades || 'Sin habilidades registradas.' }}</p>
    </section>

    <!-- BOTONES DE CONTACTO -->
    <section class="section contacto-acciones">
      <h3>Contacto directo</h3>

      <div class="acciones-grid">

        <button class="btn-action whatsapp" (click)="abrirWhatsApp()" [disabled]="!trabajador.telefono">
          <i class="bi bi-whatsapp"></i> WhatsApp
        </button>

        <button class="btn-action llamar" (click)="llamar()" [disabled]="!trabajador.telefono">
          <i class="bi bi-telephone-fill"></i> Llamar
        </button>

        <button class="btn-action correo" (click)="enviarCorreo()" [disabled]="!trabajador.correo">
          <i class="bi bi-envelope-fill"></i> Correo
        </button>

        <button class="btn-action contratar" (click)="contratar()">
          <i class="bi bi-cash-stack"></i> Contratar ahora
        </button>

      </div>
    </section>

    <!-- RESE√ëAS -->
    <section class="section resenas">
      <h3>Rese√±as</h3>

      <div *ngIf="resenas.length > 0; else sinResenas">
        <div class="resena-card" *ngFor="let r of resenas">
          <div class="resena-header">
            <span class="cliente">{{ r.cliente }}</span>
            <span class="calif">‚≠ê {{ r.calificacion }}/5</span>
          </div>
          <p>{{ r.comentarios }}</p>
          <small>{{ r.fecha_resena }}</small>
        </div>
      </div>

      <ng-template #sinResenas>
        <p class="no-resenas">A√∫n no hay rese√±as para este profesional.</p>
      </ng-template>
    </section>

  </div>
</div>

<!-- Cargando -->
<div *ngIf="!trabajador" class="cargando">
  <div class="spinner"></div>
  <p>Cargando informaci√≥n...</p>
</div>

