<div class="detalle-wrapper" *ngIf="trabajador">
  <button class="btn-regresar" routerLink="/store/services/{{ trabajador.categoria }}">
    ‚¨Ö Volver
  </button>

  <div class="card-detalle">

    <!-- FOTO + INFO PRINCIPAL -->
    <div class="perfil-header">
      <img
        [src]="urlBackend + trabajador.foto_trabajador"
        onerror="this.src='assets/img/default-user.png'"
        class="foto"
      />

      <div class="info-basica">
        <h2>{{ trabajador.nombre }} {{ trabajador.apellidos }}</h2>
        <p class="categoria">{{ trabajador.categoria | titlecase }}</p>

        

        <!-- ESTRELLAS Y PROMEDIO -->
        <div class="rating-box" *ngIf="resenas.length > 0">
          <span class="star" *ngFor="let s of [1,2,3,4,5]" 
                [class.filled]="s <= promedio">
            ‚òÖ
          </span>
          <span class="rating-text">{{ promedio }}/5</span>
        </div>

        <!-- Habilidades -->
        <div class="habilidades" *ngIf="trabajador.habilidades">
          <span *ngFor="let h of trabajador.habilidades.split(',')">
            {{ h.trim() }}
          </span>
        </div>

        <!-- BOT√ìN CONTRATAR (MUY GRANDE) -->
        <button class="btn-contratar" (click)="contratar()">
          Contratar ahora
        </button>
      </div>
    </div>

    <!-- DESCRIPCI√ìN -->
    <section class="section">
      <h3>Descripci√≥n</h3>
      <p>{{ trabajador.descripcion_trabajo || 'Sin descripci√≥n.' }}</p>
    </section>

        <!-- DESCRIPCI√ìN -->
    <section class="section">
      <h3>Ubicaci√≥n</h3>
      <p>{{ trabajador.ubicacion || 'Sin descripci√≥n.' }}</p>
    </section>

        <!-- Experiencia -->
    <section class="section">
      <h3>Experiencia</h3>
      <p>{{ trabajador.experiencia || 'Sin descripci√≥n.' }}</p>
    </section>

    <!-- ACCIONES DE CONTACTO -->
    <section class="section contacto-acciones">
      <h3>Contacto directo</h3>

      <p *ngIf="!puedeContactar" class="text-danger">
        üîí Debes contratar primero para desbloquear el contacto.
      </p>

      <div class="acciones-grid">
        <button class="btn-action whatsapp"
                (click)="abrirWhatsApp()"
                [disabled]="!puedeContactar">
          WhatsApp
        </button>

        <button class="btn-action llamar"
                (click)="llamar()"
                [disabled]="!puedeContactar">
          Llamar
        </button>

        <button class="btn-action correo"
                (click)="enviarCorreo()"
                [disabled]="!puedeContactar">
          Correo
        </button>
      </div>

    </section>

    <!-- RESE√ëAS -->
    <section class="section resenas">
      <h3>Rese√±as</h3>

      <div *ngIf="resenas.length > 0; else sinResenas">
        <div class="resena-card" *ngFor="let r of resenas">
          <strong>{{ r.cliente }}</strong>
          <span>‚≠ê {{ r.calificacion }}/5</span>
          <p>{{ r.comentarios }}</p>
          <small>{{ r.fecha_resena }}</small>
        </div>
      </div>

      <ng-template #sinResenas>
        <p class="no-resenas">A√∫n no hay rese√±as.</p>
      </ng-template>
    </section>

  </div>
</div>



